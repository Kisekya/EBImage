#!/bin/sh
# configure script substitution
# forces compilation with all Magick++ config keys
# standard configure shall come later
export CXXFLAGS="-c -g -O2 -fPIC -I. -Isrc -I$R_HOME/include `Magick++-config --cppflags --cxxflags`"
export LFLAGS="-shared -g -O2 -fPIC -L$R_HOME/lib -lR -lstdc++ `Magick++-config --cxxflags --ldflags --libs`"
g++ $CXXFLAGS inst/src/*.cpp
g++ $LFLAGS *.o -o EBImage.so
mkdir ./inst/libs
cp EBImage.so ./inst/libs
rm -f *.o
rm -f *.so

# THINK OF USING THIS FOR WINDOWS VERSION MAYBE
#echo .
#echo ============================================================
#echo EBImage USES cmake TO CONFIGURE AND MAKE...
#echo IF INSTALLATION FAILS, PLEASE CHECK IF cmake IS INSTALLED
#echo cmake of Kitware - www.cmake.org
#echo ------------------------------------------------------------
#echo Requires: libR, libMagick++ - www.imagemagick.org,
#echo           libpthread, libstdc++
#echo ------------------------------------------------------------
#echo Please ignore the warning showing that libs exists - it is
#echo non-standard configure script because of cmake usage
#echo ============================================================
#echo .
#export MAGICK_DIR=`Magick++-config --prefix`
#cmake ./inst/src
#make
#mkdir ./inst/libs
#cp libebimage.so ./inst/libs/EBImage.so
